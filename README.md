# bilayer-analysis-tools

Tools for analysis of specific bilayer system.

* [Getting started](#getting-started)
* [About tools](#about-tools)
* [About fortran_mods](#about-fortran_mods)
* [references](#references)

## Getting started

Requirements:
Each bilayer tool uses [Gnuplot](http://www.gnuplot.info/) to create png graphs.
realSpace_rigidity tools use [Gnuplot](http://www.gnuplot.info/) to fit parameter.

Installation:
```
make
```

Using:
Each tool requires two argumentsâ€”first, the name of the output folder. The results will be writing right there. Second, the name of a trajectory file generated by [Lammps](https://lammps.sandia.gov/).

```
bilayer_Dc_Lz_Doverlap my_results trajectory.lammpstrj
```
```
bilayer_Dol_Dc_Lz_N_width my_results trajectory.lammpstrj
```
```
bilayer_realSpace_rigidity my_results trajectory.lammpstrj
```
```
bilayer_realSpace_rigidity_doubleTail my_results trajectory.lammpstrj
```

## About tools

### bilayer_Dc_Lz_Doverlap
The program computes overlap parameter distribution of polymers in monolayers.

 inputs:
  * name of output directory - the first argument in command line
  * name of trajectory file  - the second argument in command line
  * setting variables:
  * tFilter - the array of particle types of bilayer
  * ddove, ddc, dlz, dd

 outputs:
  * Doverlap_dist.data - distribution of overlap 
  * Dc_dist.data       - distribution of Dc
  * Lz_dist.data       - distribution of Lz
  * Doverlap_dist.png  - plot of distribution of overlap (by Gnuplot)
  * Dc_dist.png        - plot of distribution of Dc (by Gnuplot)
  * Lz_dist.png        - plot of distribution of Lz (by Gnuplot)

### bilayer_Dol_Dc_Lz_N_width
The program computes overlap parameter of polymers in monolayers as function of width of bilayer.

_This is the oldest tool, and it uses a little more messy workflow._

inputs:
 * name of output directory - the first argument in command line
 * name of trajectory file  - the second argument in command line
 * setting variables:
    * tFilter - the array of particle types of bilayer
    * dwdt

outputs:
 * Doverlap_width_dist.data - distribution of overlap 
 * Dc_width_dist.data       - distribution of Dc
 * Lz_width_dist.data       - distribution of Lz
 * N_width_dist.data        - the number of cells with a given width
 * Doverlap_width_dist.png  - plot of distribution of overlap (by Gnuplot)
 * Dc_width_dist.png        - plot of distribution of Dc (by Gnuplot)
 * Lz_width_dist.png        - plot of distribution of Lz (by Gnuplot)
 * N_width_dist.png         - plot of the number of cells with a given width (by Gnuplot)

### bilayer_realSpace_rigidity
The program computes rigidity of bilayer.

inputs:
* name of output directory - the first argument in command line
* name of trajectory file  - the second argument in command line
* setting variables:
             - tFilter - the array of particle types of bilayer

outputs:
* neighbots.data            - the number of neighbours polymer of type "i" around the type "j"
* PSi.data                  - the distribution of "S_i"
* RS_rigidity_fit_gpl.data  - It contains the number of each type of polymers, the area of the bilayer (Lx*Ly) and the results of the fit of "P(S_i)" (by Gnuplot).
* PSi.png                   - plot of "P(S_i)" (by Gnuplot)
* PSi_fit.png               - plot of "P(S_i)" with fitting functions (by Gnuplot)

### bilayer_realSpace_rigidity_doubleTail
The program computes rigidity of bilayer which contains a polymer with two tails.

inputs:
* name of output directory - the first argument in command line
* name of trajectory file  - the second argument in command line
* setting variables:
  * tFilter - the array of particle types of bilayer

outputs:
* neighbots.data            - the number of neighbours polymer of type "i" around the type "j"
* PSi.data                  - the distribution of "S_i"
* RS_rigidity_fit_gpl.data  - It contains the number of each type of polymers, the area of the bilayer (Lx*Ly) and the results of the fit of "P(S_i)" (by Gnuplot).
* PSi.png                   - plot of "P(S_i)" (by Gnuplot)
* PSi_fit.png               - plot of "P(S_i)" with fitting functions (by Gnuplot)

## About fortran_mods
The module contains some necessary modules for bilayer_tools.

### config_mod
The object which represents one configuration read from trajectory file by lmp_traject_reader_mod.

### gnuplot_mod
The object serves Gnuplot. It's an experimental module, and I am not sure it is useful, but it's work.

### lmp_traject_reader_mod
The module contains a collection of variables, function and subroutines, which handled with trajectory file and config object (config_mod).
For now, it can read only custom format of dump file with id, mol, type, rad, x, y and z columns.

### mol_pattern_mod
The object contains a collection of patterns objects (single_patt_mod) and methods for finding of molecules by patterns in trajectory files.

### single_patt_mod
The object represents a molecular pattern.

## References
* [Lammps](https://lammps.sandia.gov/)
* [Gnuplot](http://www.gnuplot.info/)
* bylayer analysis
    * Venturoli, M., Sperotto, M. M., Kranenburg, M., & Smit, B. (2006). Mesoscopic models of biological membranes. Physics Reports, 437(1-2), 1-54.
* ITIM
    * Sega, M., Kantorovich, S. S., Jedlovszky, P., & Jorge, M. (2013). The generalized identification of truly interfacial molecules (ITIM) algorithm for nonplanar interfaces. The Journal of chemical physics, 138(4), 044110.
* RealSpace rigidity
    * Doktorova, M., Harries, D., & Khelashvili, G. (2017). Determination of bending rigidity and tilt modulus of lipid membranes from real-space fluctuation analysis of molecular dynamics simulations. Physical Chemistry Chemical Physics, 19(25), 16806-16818.
    * Johner, N., Harries, D., & Khelashvili, G. (2016). Implementation of a methodology for determining elastic properties of lipid assemblies from molecular dynamics simulations. BMC bioinformatics, 17(1), 161.
